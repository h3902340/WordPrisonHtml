(()=>{"use strict";var e={d:(r,t)=>{for(var a in t)e.o(t,a)&&!e.o(r,a)&&Object.defineProperty(r,a,{enumerable:!0,get:t[a]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r)};e.d({},{X:()=>S});var r="#FC9B45",t="#51A6FF",a="#FFFFFF",o=50,n=50,i=30,D="".concat(i,"px Arial"),d="動";function l(e){return r=this,t=void 0,o=function(){return function(e,r){var t,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:D(0),throw:D(1),return:D(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function D(D){return function(d){return function(D){if(t)throw new TypeError("Generator is already executing.");for(;n&&(n=0,D[0]&&(i=0)),i;)try{if(t=1,a&&(o=2&D[0]?a.return:D[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,D[1])).done)return o;switch(a=0,o&&(D=[2&D[0],o.value]),D[0]){case 0:case 1:o=D;break;case 4:return i.label++,{value:D[1],done:!1};case 5:i.label++,a=D[1],D=[0];continue;case 7:D=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==D[0]&&2!==D[0])){i=0;continue}if(3===D[0]&&(!o||D[1]>o[0]&&D[1]<o[3])){i.label=D[1];break}if(6===D[0]&&i.label<o[1]){i.label=o[1],o=D;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(D);break}o[2]&&i.ops.pop(),i.trys.pop();continue}D=r.call(e,i)}catch(e){D=[6,e],a=0}finally{t=o=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([D,d])}}}(this,(function(r){return[2,new Promise((function(r){return setTimeout(r,e)}))]}))},new((a=void 0)||(a=Promise))((function(e,n){function i(e){try{d(o.next(e))}catch(e){n(e)}}function D(e){try{d(o.throw(e))}catch(e){n(e)}}function d(r){var t;r.done?e(r.value):(t=r.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,D)}d((o=o.apply(r,t||[])).next())}));var r,t,a,o}function I(e){S.clearRect(e.x,e.y,e.w,e.h)}function u(e){e.cardInfo.PartOfSpeech==d?S.fillStyle=t:S.fillStyle=r;var D=o*e.cardInfo.Word.length;S.fillRect(e.rect.x,e.rect.y,D,n),S.fillStyle=a,S.fillText(e.cardInfo.Word,e.rect.x+.5*(D-i*e.cardInfo.Word.length),e.rect.y+35)}function C(e,r,t){S.beginPath(),S.rect(e.x,e.y,e.w,e.h),S.lineWidth=t,S.strokeStyle=r,S.stroke()}var c=function(){function e(){this.cardArray=[],this.inventoryTailX=110,this.inventoryTailY=350,this.rect={x:100,y:340,w:600,h:220}}return e.prototype.drawInventory=function(){var e;I(this.rect),e=this.rect,S.fillStyle="#BEBEBE",S.fillRect(e.x,e.y,e.w,e.h);for(var r=0;r<this.cardArray.length;r++)this.cardArray[r].isSelected||u(this.cardArray[r])},e.prototype.addCard=function(e){var r=o*e.Word.length;this.inventoryTailX+10+r>600&&(this.inventoryTailY+=10+n),this.cardArray.push({rect:{x:this.inventoryTailX,y:this.inventoryTailY,w:r,h:n},inventoryX:this.inventoryTailX,inventoryY:this.inventoryTailY,cardInfo:e,isSelected:!1}),this.inventoryTailX=this.inventoryTailX+r+10},e}(),s=function(){function e(e){this.verticalInterval=5,this.rect=e}return e.prototype.say=function(e){return r=this,t=void 0,n=function(){var r,t,o,n;return function(e,r){var t,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:D(0),throw:D(1),return:D(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function D(D){return function(d){return function(D){if(t)throw new TypeError("Generator is already executing.");for(;n&&(n=0,D[0]&&(i=0)),i;)try{if(t=1,a&&(o=2&D[0]?a.return:D[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,D[1])).done)return o;switch(a=0,o&&(D=[2&D[0],o.value]),D[0]){case 0:case 1:o=D;break;case 4:return i.label++,{value:D[1],done:!1};case 5:i.label++,a=D[1],D=[0];continue;case 7:D=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==D[0]&&2!==D[0])){i=0;continue}if(3===D[0]&&(!o||D[1]>o[0]&&D[1]<o[3])){i.label=D[1];break}if(6===D[0]&&i.label<o[1]){i.label=o[1],o=D;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(D);break}o[2]&&i.ops.pop(),i.trys.pop();continue}D=r.call(e,i)}catch(e){D=[6,e],a=0}finally{t=o=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([D,d])}}}(this,(function(d){switch(d.label){case 0:I(this.rect),S.font=D,r=function(e,r){for(var t=[],a=0;a<e.length;a+=20)t.push(e.substring(a,a+20));return t}(e),t=0,d.label=1;case 1:if(!(t<r.length))return[3,6];o=r[t],n=1,d.label=2;case 2:return n<=o.length?(S.fillStyle=a,S.fillText(o.substring(0,n),this.rect.x,this.rect.y+i+(i+this.verticalInterval)*t),[4,l(20)]):[3,5];case 3:d.sent(),d.label=4;case 4:return n++,[3,2];case 5:return t++,[3,1];case 6:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,a){function i(e){try{d(n.next(e))}catch(e){a(e)}}function D(e){try{d(n.throw(e))}catch(e){a(e)}}function d(r){var t;r.done?e(r.value):(t=r.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,D)}d((n=n.apply(r,t||[])).next())}));var r,t,o,n},e}(),h=function(){function e(e,r,t){this.lineWidth=6,this.rect=e,this.partOfSpeech=r,this.card=t}return e.prototype.drawSlot=function(){I(this.rect),this.partOfSpeech==d?C(this.rect,t,this.lineWidth):C(this.rect,r,this.lineWidth),this.card&&function(e,o,D){e.cardInfo.PartOfSpeech==d?S.fillStyle=t:S.fillStyle=r;var l=50*e.cardInfo.Word.length,I=o-.5*l,u=D-.5*n;S.fillRect(I,u,l,n),S.fillStyle=a,S.fillText(e.cardInfo.Word,I+.5*(l-i*e.cardInfo.Word.length),u+35)}(this.card,this.rect.x+.5*this.rect.w,this.rect.y+.5*this.rect.h)},e.prototype.InsertCard=function(e){this.card=e,e.isSelected=!0,e.rect.x=this.rect.x+.5*(this.rect.w-e.rect.w),e.rect.y=this.rect.y},e.prototype.RemoveCard=function(){this.card=null},e.prototype.IsCardEqual=function(e){return this.card==e},e.prototype.GetCardID=function(){return this.card?this.card.cardInfo.ID:-1},e.prototype.HasCard=function(){return null!=this.card},e}();const f=JSON.parse('[{"ID":0,"Word":"我","PartOfSpeech":"名"},{"ID":1,"Word":"檢視","PartOfSpeech":"動"},{"ID":2,"Word":"密室","PartOfSpeech":"名"},{"ID":3,"Word":"桌子","PartOfSpeech":"名"},{"ID":4,"Word":"門","PartOfSpeech":"名"},{"ID":5,"Word":"移至","PartOfSpeech":"動"},{"ID":6,"Word":"開","PartOfSpeech":"動"},{"ID":7,"Word":"角落","PartOfSpeech":"名"},{"ID":8,"Word":"爬上","PartOfSpeech":"動"},{"ID":9,"Word":"天花板","PartOfSpeech":"名"},{"ID":10,"Word":"方塊","PartOfSpeech":"名"},{"ID":11,"Word":"問","PartOfSpeech":"動"},{"ID":12,"Word":"黑衣人","PartOfSpeech":"名"}]'),g=JSON.parse('[{"ID":0,"Dialogue":"這裡是哪裡？「我」醒了過來。發現在自己被困在一間「密室」。我摸著自己的口袋，沒有找到手機，無法對外聯繫。但發現一張藍色卡片「檢視」。這是做什麼用的？（獲得「密室」、「我」、「檢視」）"},{"ID":1,"Dialogue":"我檢視這密室。看見密室內有一扇「門」與一張「桌子」。沒有別的東西了。"},{"ID":2,"Dialogue":"我已經檢視過這密室。密室內除了一扇門與一張桌子外，沒有其他特別的東西了。"},{"ID":3,"Dialogue":"我檢視這張桌子。外觀很像开這個字。好像沒有其他值得注意的地方了。"},{"ID":4,"Dialogue":"桌子外觀很像开這個字。好像沒有其他特別的地方了。"},{"ID":5,"Dialogue":"我靠近這扇門並檢視。是一扇很大的門。我感覺整個人在門的下面。忽然間，眼前閃了一道光芒。原來人在門的下面，就成了閃字。我回想起小時候，有人曾在桌子底下寫字。"},{"ID":6,"Dialogue":"我看見桌子在大門之下，形成了「開」這個字。（獲得「開」）"},{"ID":7,"Dialogue":"桌子原本在密室的中央，我將桌子移至大門下面。"},{"ID":8,"Dialogue":"桌子已經移至大門之下了。"},{"ID":9,"Dialogue":"我開啟大門。我來到一間審訊室。眼前坐著一個高大的黑衣人。我盯著黑衣人，他一語不發，但同時我也無法和他說話。我聽見背後的大門自動關上。我被困在這裡了。（遊戲結束）"},{"ID":10,"Dialogue":"桌面是可以活動的。我將桌面掀開。看見裡面有兩張卡片，一黃一藍，「角落」、「爬上」。（獲得「角落」、「爬上」）"},{"ID":11,"Dialogue":"我檢視著密室的角落。什麼也沒有。"},{"ID":12,"Dialogue":"我將桌子移至密室的角落。"},{"ID":13,"Dialogue":"我已經將桌子移至密室角落。"},{"ID":14,"Dialogue":"我爬上桌子。我看見頭頂上就是「天花板」。（獲得「天花板」）"},{"ID":15,"Dialogue":"我爬上桌子。頭頂上是天花板。"},{"ID":16,"Dialogue":"我檢視天花板。天花板是由一塊一塊木板拼湊而成。"},{"ID":17,"Dialogue":"角落上方的天花板太高，我摸不到。"},{"ID":18,"Dialogue":"我爬上門上方的天花板。天花板上是一個很狹小的空間。我找到了一個木製的「方塊」。隨後，我下來至密室中央。（獲得「方塊」）"},{"ID":19,"Dialogue":"我檢視這方塊。方塊中間有一個貫穿方塊的方洞。沒有其他特別的地方了。方塊大概有一顆頭這麼大。"},{"ID":20,"Dialogue":"我將方塊移至大門前。"},{"ID":21,"Dialogue":"我檢視大門。方塊在大門之下形成了「問」這個字。"},{"ID":22,"Dialogue":"我開啟大門。我來到一間審訊室。眼前坐著一個高大的「黑衣人」。他盯著我看，卻不發一語。這時密室的門自動關上。我在困在這裡了。（獲得「黑衣人」）"},{"ID":23,"Dialogue":"我檢視黑衣人。穿著黑色大衣，大概有190公分高。"},{"ID":24,"Dialogue":"黑衣人似乎不聽從我的指令。"},{"ID":25,"Dialogue":"我問黑衣人：「文華在哪裡？」黑衣人眼神呆滯了一下，並回答：「吊在樹上。」"},{"ID":26,"Dialogue":"黑衣人問我：「文華是什麼？」黑衣人回答：「小木屋。」這時我們相擁而泣，我找到了我的兒時玩伴。文華是我們小時候的秘密基地。沒想到會在這裡見面，是誰把我們安排在這個地方？"},{"ID":27,"Dialogue":"黑衣人爬上桌子。"},{"ID":28,"Dialogue":"黑衣人身高夠高，他將角落的天花板掀開。"},{"ID":29,"Dialogue":"黑衣人爬上角落上方的天花板。他看見上面似乎是一個通道。"},{"ID":30,"Dialogue":"黑衣人在天花板上。他拉了我一把，我成功爬上了天花板。我和他穿越通道，遠方越來越明亮。我們來到洞穴出口。遠方是一座城市。我打算通報警察這件事。（恭喜通關）"},{"ID":31,"Dialogue":"黑衣人檢視門。門在他面前就沒有顯得這麼高大。"},{"ID":32,"Dialogue":"黑衣人檢視我。他一臉難以置信，會在這個地方見到以前的朋友。"},{"ID":33,"Dialogue":"黑衣人檢視方塊。他回想起小木屋的小書櫃，裡面有許多本小說。"},{"ID":34,"Dialogue":"黑衣人檢視桌子。他回想起小木屋內也曾有一張一模一樣的桌子。"},{"ID":35,"Dialogue":"黑衣人檢視天花板。天花板由許多木板拼成，很像是小木屋的建材。"},{"ID":36,"Dialogue":"黑衣人檢視密室。他剛才似乎也被困在一間密室內，也是沒有什麼東西。"},{"ID":37,"Dialogue":"黑衣人檢視角落。他也沒看到什麼東西。"},{"ID":38,"Dialogue":"我已經開啟過桌面。在裡面發現兩張卡片「角落」、「爬上」。沒有其他東西了。"},{"ID":39,"Dialogue":"我滑開門上方的天花板，一架梯子掉了下來。"},{"ID":40,"Dialogue":"角落上方的天花板已經被掀開。"},{"ID":41,"Dialogue":"門上方的天花板已經被掀開。"},{"ID":42,"Dialogue":"黑衣人爬上門上方的天花板。除了我剛才找到的方塊，他在裡面沒有找到其他東西了。"},{"ID":43,"Dialogue":"我檢視這扇門。是一扇很大的門。沒有其他特別的地方了。"},{"ID":44,"Dialogue":"我站在地上。天花板太高，我摸不到。"},{"ID":45,"Dialogue":"黑衣人站在地上，摸不到天花板。"},{"ID":46,"Dialogue":"門上方天花板是封閉的，我無法爬上。"},{"ID":47,"Dialogue":"我已經爬上門上方的天花板。在裡面找到一個方塊，沒有其他東西了。"},{"ID":48,"Dialogue":"我已經將方塊移至大門前了。"},{"ID":49,"Dialogue":"我將方塊移至角落。什麼也沒發生。"},{"ID":50,"Dialogue":"我已經將方塊移至角落了。"},{"ID":51,"Dialogue":"黑衣人站了起來，走向門，掏出鑰匙將門解鎖並開啟。原來他有鑰匙！"},{"ID":52,"Dialogue":"我目前沒有想問他的問題了。"},{"ID":53,"Dialogue":"黑衣人沒有想我的問題了。"},{"ID":54,"Dialogue":"我們都被困在這間審訊室。無法回到我剛才的密室。"},{"ID":55,"Dialogue":"黑衣人已經將門開啟。"},{"ID":56,"Dialogue":"角落上方的天花板是封閉的，黑衣人無法爬上。"},{"ID":57,"Dialogue":"我檢視桌子底下，果然發現有用簽字筆寫的兩個字「移至」。（獲得「移至」）"},{"ID":58,"Dialogue":"桌子外觀很像开這個字。除了剛才發現的字跡，好像沒有其他特別的地方了。"}]'),y=JSON.parse('[{"CardID1":0,"CardID2":1,"CardID3":2,"Condition":{"MeInspectRoom":0},"NewCardID":[3,4],"DialogueID":1,"Consequence":{"MeInspectRoom":1}},{"CardID1":0,"CardID2":1,"CardID3":2,"Condition":{"MeInspectRoom":1},"DialogueID":2},{"CardID1":0,"CardID2":1,"CardID3":3,"Condition":{"MeInspectTable":0,"MeInspectDoor":0},"DialogueID":3,"Consequence":{"MeInspectTable":1}},{"CardID1":0,"CardID2":1,"CardID3":3,"Condition":{"MeInspectTable":1,"MeInspectDoor":0},"DialogueID":4},{"CardID1":0,"CardID2":1,"CardID3":3,"Condition":{"MeInspectDoor":1,"MoveToGot":0},"NewCardID":[5],"DialogueID":57,"Consequence":{"MoveToGot":1}},{"CardID1":0,"CardID2":1,"CardID3":3,"Condition":{"MeInspectDoor":1,"MoveToGot":1},"DialogueID":58},{"CardID1":0,"CardID2":1,"CardID3":4,"Condition":0,"DialogueID":5},{"CardID1":0,"CardID2":1,"CardID3":4,"Condition":1,"NewCardID":[6],"DialogueID":6},{"CardID1":0,"CardID2":1,"CardID3":4,"Condition":2,"NewCardID":[11],"DialogueID":21},{"CardID1":0,"CardID2":1,"CardID3":4,"Condition":3,"DialogueID":43},{"CardID1":3,"CardID2":5,"CardID3":4,"Condition":0,"DialogueID":7},{"CardID1":3,"CardID2":5,"CardID3":4,"Condition":1,"DialogueID":8},{"CardID1":0,"CardID2":6,"CardID3":4,"Condition":0,"DialogueID":9},{"CardID1":0,"CardID2":6,"CardID3":4,"Condition":1,"NewCardID":[12],"DialogueID":22},{"CardID1":0,"CardID2":6,"CardID3":3,"Condition":0,"NewCardID":[7,8],"DialogueID":10},{"CardID1":0,"CardID2":6,"CardID3":3,"Condition":1,"DialogueID":38},{"CardID1":3,"CardID2":5,"CardID3":7,"Condition":0,"DialogueID":12},{"CardID1":3,"CardID2":5,"CardID3":7,"Condition":1,"DialogueID":13},{"CardID1":0,"CardID2":8,"CardID3":3,"Condition":0,"NewCardID":[9],"DialogueID":14},{"CardID1":0,"CardID2":8,"CardID3":3,"Condition":1,"DialogueID":15},{"CardID1":0,"CardID2":1,"CardID3":7,"Condition":0,"DialogueID":11},{"CardID1":0,"CardID2":1,"CardID3":9,"Condition":0,"DialogueID":16},{"CardID1":0,"CardID2":6,"CardID3":9,"Condition":0,"DialogueID":44},{"CardID1":0,"CardID2":6,"CardID3":9,"Condition":1,"DialogueID":17},{"CardID1":0,"CardID2":6,"CardID3":9,"Condition":2,"DialogueID":39},{"CardID1":0,"CardID2":6,"CardID3":9,"Condition":3,"DialogueID":40},{"CardID1":0,"CardID2":6,"CardID3":9,"Condition":4,"DialogueID":41},{"CardID1":0,"CardID2":8,"CardID3":9,"Condition":0,"DialogueID":44},{"CardID1":0,"CardID2":8,"CardID3":9,"Condition":1,"DialogueID":17},{"CardID1":0,"CardID2":8,"CardID3":9,"Condition":2,"DialogueID":46},{"CardID1":0,"CardID2":8,"CardID3":9,"Condition":3,"NewCardID":[10],"DialogueID":18},{"CardID1":0,"CardID2":8,"CardID3":9,"Condition":4,"DialogueID":47},{"CardID1":0,"CardID2":8,"CardID3":9,"Condition":5,"DialogueID":30},{"CardID1":10,"CardID2":5,"CardID3":4,"Condition":0,"DialogueID":20},{"CardID1":10,"CardID2":5,"CardID3":4,"Condition":1,"DialogueID":48},{"CardID1":10,"CardID2":5,"CardID3":7,"Condition":2,"DialogueID":49},{"CardID1":10,"CardID2":5,"CardID3":7,"Condition":3,"DialogueID":50},{"CardID1":0,"CardID2":1,"CardID3":10,"Condition":0,"DialogueID":19},{"CardID1":0,"CardID2":1,"CardID3":12,"Condition":0,"DialogueID":23},{"CardID1":12,"CardID2":-2,"CardID3":-2,"Condition":0,"DialogueID":24},{"CardID1":0,"CardID2":11,"CardID3":12,"Condition":0,"DialogueID":25},{"CardID1":0,"CardID2":11,"CardID3":12,"Condition":1,"DialogueID":52},{"CardID1":12,"CardID2":11,"CardID3":0,"Condition":0,"DialogueID":26},{"CardID1":12,"CardID2":11,"CardID3":0,"Condition":1,"DialogueID":53},{"CardID1":-2,"CardID2":-2,"CardID3":-2,"Condition":0,"DialogueID":54},{"CardID1":12,"CardID2":6,"CardID3":4,"Condition":0,"DialogueID":51},{"CardID1":12,"CardID2":6,"CardID3":4,"Condition":1,"DialogueID":55},{"CardID1":12,"CardID2":8,"CardID3":3,"Condition":0,"DialogueID":27},{"CardID1":12,"CardID2":6,"CardID3":9,"Condition":0,"DialogueID":28},{"CardID1":12,"CardID2":6,"CardID3":9,"Condition":1,"DialogueID":40},{"CardID1":12,"CardID2":6,"CardID3":9,"Condition":2,"DialogueID":41},{"CardID1":12,"CardID2":8,"CardID3":9,"Condition":0,"DialogueID":45},{"CardID1":12,"CardID2":8,"CardID3":9,"Condition":1,"DialogueID":42},{"CardID1":12,"CardID2":8,"CardID3":9,"Condition":2,"DialogueID":56},{"CardID1":12,"CardID2":8,"CardID3":9,"Condition":3,"DialogueID":29},{"CardID1":12,"CardID2":1,"CardID3":4,"Condition":0,"DialogueID":31},{"CardID1":12,"CardID2":1,"CardID3":0,"Condition":0,"DialogueID":32},{"CardID1":12,"CardID2":1,"CardID3":10,"Condition":0,"DialogueID":33},{"CardID1":12,"CardID2":1,"CardID3":3,"Condition":0,"DialogueID":34},{"CardID1":12,"CardID2":1,"CardID3":9,"Condition":0,"DialogueID":35},{"CardID1":12,"CardID2":1,"CardID3":2,"Condition":0,"DialogueID":36},{"CardID1":12,"CardID2":1,"CardID3":7,"Condition":0,"DialogueID":37}]');var p=function(e,r,t,a){return new(t||(t=Promise))((function(o,n){function i(e){try{d(a.next(e))}catch(e){n(e)}}function D(e){try{d(a.throw(e))}catch(e){n(e)}}function d(e){var r;e.done?o(e.value):(r=e.value,r instanceof t?r:new t((function(e){e(r)}))).then(i,D)}d((a=a.apply(e,r||[])).next())}))},v=function(e,r){var t,a,o,n,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return n={next:D(0),throw:D(1),return:D(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function D(D){return function(d){return function(D){if(t)throw new TypeError("Generator is already executing.");for(;n&&(n=0,D[0]&&(i=0)),i;)try{if(t=1,a&&(o=2&D[0]?a.return:D[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,D[1])).done)return o;switch(a=0,o&&(D=[2&D[0],o.value]),D[0]){case 0:case 1:o=D;break;case 4:return i.label++,{value:D[1],done:!1};case 5:i.label++,a=D[1],D=[0];continue;case 7:D=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==D[0]&&2!==D[0])){i=0;continue}if(3===D[0]&&(!o||D[1]>o[0]&&D[1]<o[3])){i.label=D[1];break}if(6===D[0]&&i.label<o[1]){i.label=o[1],o=D;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(D);break}o[2]&&i.ops.pop(),i.trys.pop();continue}D=r.call(e,i)}catch(e){D=[6,e],a=0}finally{t=o=0}if(5&D[0])throw D[1];return{value:D[0]?D[1]:void 0,done:!0}}([D,d])}}},w=function(){function e(){var e=this;this.cardTable=new Map,this.dialogueTable=new Map,this.inventory=new c,this.slotArray=[new h({x:145,y:270,w:150,h:50},"名",null),new h({x:325,y:270,w:150,h:50},d,null),new h({x:505,y:270,w:150,h:50},"名",null)],this.typeWriter=new s({x:100,y:70,w:600,h:190}),f.forEach((function(r){e.cardTable.set(r.ID,r)})),this.sentenceTable=y,g.forEach((function(r){e.dialogueTable.set(r.ID,r.Dialogue)})),this.levelState={MeInspectRoom:0,MeInspectDoor:0,MoveToGot:0}}return e.prototype.begin=function(){this.entrySequence()},e.prototype.entrySequence=function(){return p(this,void 0,void 0,(function(){var e;return v(this,(function(r){switch(r.label){case 0:for(e=0;e<this.slotArray.length;e++)this.slotArray[e].drawSlot();return this.inventory.drawInventory(),[4,this.typeWriter.say(this.dialogueTable.get(0))];case 1:return r.sent(),this.inventory.addCard(this.cardTable.get(2)),this.inventory.addCard(this.cardTable.get(0)),this.inventory.addCard(this.cardTable.get(1)),this.inventory.drawInventory(),[2]}}))}))},e.prototype.onCanvasClick=function(e){var r=this;this.inventory.cardArray.forEach((function(t){var a,o;if(a=e,o=t.rect,a.x>o.x&&a.x<o.x+o.w&&a.y<o.y+o.h&&a.y>o.y)if(t.isSelected){t.rect.x=t.inventoryX,t.rect.y=t.inventoryY,t.isSelected=!1;for(var n=0;n<r.slotArray.length;n++)if(r.slotArray[n].IsCardEqual(t)){r.slotArray[n].RemoveCard(),r.slotArray[n].drawSlot(),r.inventory.drawInventory();break}}else{for(n=0;n<r.slotArray.length;n++){var i=r.slotArray[n];if(i.partOfSpeech==t.cardInfo.PartOfSpeech&&i.IsCardEqual(null)){i.InsertCard(t),i.drawSlot(),r.inventory.drawInventory();break}}if(r.isSlotFull())for(n=0;n<r.sentenceTable.length;n++){var D=r.sentenceTable[n];if(r.isSentenceMatch(D)){var d=!0;for(var l in D.Condition)if(r.levelState[l]!=D.Condition[l]){d=!1;break}if(d){if(r.SayDialogue(D),D.Consequence)for(var l in D.Consequence)r.levelState[l]=D.Consequence[l];break}}}}}))},e.prototype.isSlotFull=function(){return this.slotArray[0].HasCard()&&this.slotArray[1].HasCard()&&this.slotArray[2].HasCard()},e.prototype.isSentenceMatch=function(e){return e.CardID1==this.slotArray[0].GetCardID()&&e.CardID2==this.slotArray[1].GetCardID()&&e.CardID3==this.slotArray[2].GetCardID()},e.prototype.SayDialogue=function(e){return p(this,void 0,void 0,(function(){var r;return v(this,(function(t){switch(t.label){case 0:return[4,this.typeWriter.say(this.dialogueTable.get(e.DialogueID))];case 1:if(t.sent(),e.NewCardID){for(r=0;r<e.NewCardID.length;r++)this.inventory.addCard(this.cardTable.get(e.NewCardID[r]));this.inventory.drawInventory()}return[2]}}))}))},e}(),b=document.getElementById("mainCanvas"),S=b.getContext("2d"),x=new w;b.addEventListener("click",(function(e){var r=function(e,r){var t=e.getBoundingClientRect();return{x:r.clientX-t.left,y:r.clientY-t.top}}(b,e);x.onCanvasClick(r)})),x.begin()})();
//# sourceMappingURL=main.js.map